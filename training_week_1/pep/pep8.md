# PEP 8 — Полное руководство по стилю кода Python

## Введение

PEP 8 (Python Enhancement Proposal 8) — это официальное руководство по стилю кода для языка Python, созданное Гвидо ван Россумом, Барри Уорсо и Алиссой Когланом в 2001 году[^1][^2]. Этот документ определяет соглашения о том, как писать код для языка Python, включая стандартную библиотеку[^3]. Основная цель PEP 8 — улучшить читабельность кода и сделать его согласованным между большим числом проектов[^3][^4].

### Ключевые принципы

Главная идея Гвидо ван Россума заключается в том, что **код читается намного больше раз, чем пишется**[^3][^4]. Поэтому рекомендации направлены на улучшение читабельности кода и создание единообразного стиля написания[^3].

Согласованность имеет несколько уровней важности[^3]:

- Согласованность с PEP 8 важна
- Согласованность внутри проекта еще важнее
- Согласованность внутри модуля или функции — самое важное


## Структура кода

### Отступы

**Используйте 4 пробела на каждый уровень отступа**[^5][^6]. Это основное правило PEP 8 для структурирования кода[^7].

```python
# Правильно:
def my_function():
    if condition:
        return True
    return False
```

Пробелы предпочтительнее табуляции. Python 3 запрещает смешивание табуляции и пробелов для отступов[^5].

### Максимальная длина строки

Ограничьте все строки максимум **79 символами**[^5]. Для блоков текста с меньшими структурными ограничениями (строки документации или комментарии) длина строки должна быть ограничена **72 символами**[^5].

```python
# Правильно:
def long_function_name(var_one, var_two,
                       var_three, var_four):
    print(var_one)

# Правильно (висячий отступ):
def long_function_name(
        var_one, var_two, var_three,
        var_four):
    print(var_one)
```


### Пустые строки

- Функции и классы верхнего уровня отделяются **двумя пустыми строками**[^5]
- Определения методов внутри класса разделяются **одной пустой строкой**[^5]
- Дополнительные пустые строки могут использоваться для разделения групп связанных функций[^5]

```python
class MyClass:
    """Описание класса."""
    
    def __init__(self):
        pass
    
    def method_one(self):
        pass


def function_one():
    pass


def function_two():
    pass
```


### Кодировка файлов

Код в основной дистрибуции Python всегда должен использовать UTF-8 и не должен содержать объявления кодировки[^5]. В стандартной библиотеке кодировки, отличные от UTF-8, должны использоваться только для тестирования[^5].

## Импорты

### Правила импортирования

- Импорты обычно должны быть на отдельных строках[^5]:

```python
# Правильно:
import os
import sys

# Неправильно:
import sys, os
```

- Импорты всегда размещаются в начале файла, сразу после комментариев к модулю и строк документации[^5]


### Порядок импортов

Импорты должны быть сгруппированы в следующем порядке[^5]:

1. Импорты стандартной библиотеки
2. Импорты связанных сторонних библиотек
3. Импорты локальных приложений/библиотек

Между каждой группой импортов следует помещать пустую строку[^5].

```python
# Стандартная библиотека
import os
import sys

# Сторонние библиотеки
import requests
import numpy as np

# Локальные импорты
from myproject import mymodule
from . import sibling_module
```


## Пробелы в выражениях и операторах

### Избегайте лишних пробелов

- Внутри круглых, квадратных или фигурных скобок[^5]:

```python
# Правильно:
spam(ham[^1], {eggs: 2})

# Неправильно:
spam( ham[ 1 ], { eggs: 2 } )
```

- Перед запятой, точкой с запятой или двоеточием[^5]:

```python
# Правильно:
if x == 4: print(x, y); x, y = y, x

# Неправильно:
if x == 4 : print(x , y) ; x , y = y , x
```


### Рекомендации по пробелам

- Всегда окружайте бинарные операторы одним пробелом с каждой стороны[^5]:

```python
# Правильно:
i = i + 1
submitted += 1
x = x*2 - 1
hypot2 = x*x + y*y
c = (a+b) * (a-b)
```

- Не используйте пробелы вокруг знака `=` при указании аргумента по ключевому слову[^5]:

```python
# Правильно:
def complex(real, imag=0.0):
    return magic(r=real, i=imag)

# Неправильно:
def complex(real, imag = 0.0):
    return magic(r = real, i = imag)
```


## Соглашения по именованию

### Стили именования

PEP 8 определяет несколько стилей именования[^5]:

- `lowercase` — строчные буквы
- `lower_case_with_underscores` — строчные буквы с подчеркиваниями
- `UPPERCASE` — заглавные буквы
- `UPPER_CASE_WITH_UNDERSCORES` — заглавные буквы с подчеркиваниями
- `CapitalizedWords` или `CamelCase` — каждое слово с заглавной буквы
- `mixedCase` — смешанный регистр (отличается от CapitalizedWords строчной первой буквой)


### Конкретные соглашения

**Переменные и функции**: используйте строчные буквы с подчеркиваниями[^8]:

```python
my_variable = 42
def calculate_sum(numbers):
    pass
```

**Классы**: используйте CapWords (CamelCase)[^8][^5]:

```python
class MyClassName:
    pass

class HTTPServerError:  # Аббревиатуры пишутся заглавными
    pass
```

**Константы**: используйте заглавные буквы с подчеркиваниями[^8][^5]:

```python
MAX_OVERFLOW = 100
TOTAL = 50
```

**Методы и аргументы**[^5]:

- Всегда используйте `self` для первого аргумента методов экземпляра
- Всегда используйте `cls` для первого аргумента методов класса


### Подчеркивания в именах

- `_single_leading_underscore`: слабый индикатор "внутреннего использования"[^5]
- `single_trailing_underscore_`: используется для избежания конфликтов с ключевыми словами Python[^5]
- `__double_leading_underscore`: вызывает искажение имени при именовании атрибута класса[^5]
- `__double_leading_and_trailing_underscore__`: "магические" объекты или атрибуты[^5]


## Комментарии

### Общие правила для комментариев

- Ограничьте длину строки комментариев 72 символами[^9][^10]
- Комментарии должны быть полными предложениями, начинающимися с заглавной буквы[^9][^10]
- Обновляйте комментарии при изменении кода[^9]


### Блочные комментарии

Блочные комментарии применяются к коду, который следует за ними, и имеют тот же уровень отступа[^9]:

```python
# Это блочный комментарий, который объясняет
# следующий блок кода. Каждая строка начинается
# с символа # и одного пробела.
#
# Абзацы разделяются строкой с одним символом #.
for i in range(10):
    print(i)
```


### Встроенные комментарии

Встроенные комментарии должны использоваться экономно[^9]:

```python
x = x + 1  # Увеличиваем x на единицу
```


## Строки документации (Docstrings)

Строки документации — это строки, заключенные в тройные кавычки[^9]. Они должны писаться для всех публичных модулей, функций, классов и методов:

```python
def calculate_area(radius):
    """Вычисляет площадь круга по радиусу.
    
    Args:
        radius (float): Радиус круга.
        
    Returns:
        float: Площадь круга.
    """
    return 3.14159 * radius ** 2
```


## Рекомендации по программированию

### Сравнения

- Сравнения с синглетонами, такими как None, всегда должны выполняться с помощью `is` или `is not`[^5]:

```python
# Правильно:
if foo is not None:

# Неправильно:
if foo != None:
```


### Функции

- Всегда используйте оператор `def` вместо оператора присваивания, который связывает лямбда-выражение с идентификатором[^5]:

```python
# Правильно:
def f(x):
    return 2*x

# Неправильно:
f = lambda x: 2*x
```


### Исключения

- Наследуйте исключения от `Exception`, а не от `BaseException`[^5]
- При перехвате исключений указывайте конкретные исключения вместо использования голого `except:`[^5]:

```python
# Правильно:
try:
    import platform_specific_module
except ImportError:
    platform_specific_module = None

# Неправильно:
try:
    import platform_specific_module
except:
    platform_specific_module = None
```


### Возвращаемые значения

- Будьте последовательны в операторах возврата[^5]:

```python
# Правильно:
def foo(x):
    if x >= 0:
        return math.sqrt(x)
    else:
        return None

# Неправильно:
def foo(x):
    if x >= 0:
        return math.sqrt(x)
```


### Проверка типов и последовательностей

- Используйте `isinstance()` вместо прямого сравнения типов[^5]:

```python
# Правильно:
if isinstance(obj, int):

# Неправильно:
if type(obj) is type(1):
```

- Для последовательностей используйте тот факт, что пустые последовательности ложны[^5]:

```python
# Правильно:
if not seq:
if seq:

# Неправильно:
if len(seq):
if not len(seq):
```


## Инструменты для проверки соответствия PEP 8

Существуют различные инструменты для автоматической проверки кода на соответствие PEP 8[^11][^12]:

- **flake8** — популярный инструмент для проверки стиля кода
- **pylint** — более комплексный анализатор кода
- **black** — автоформатировщик кода
- **ruff** — быстрый современный линтер

Установка и использование flake8[^11]:

```bash
pip install flake8
flake8 myfile.py
```


## Заключение

PEP 8 — это не просто набор правил, а философия написания читаемого и поддерживаемого кода[^4]. Следование этим рекомендациям особенно важно при работе в команде, так как единый стиль кодирования упрощает совместную разработку и понимание кода другими разработчиками[^11][^13].

Помните, что PEP 8 — это руководство, а не жесткие правила. Важно понимать, когда можно отступить от рекомендаций, особенно если это улучшает читаемость кода или соответствует установленному стилю проекта[^3][^5].

<div style="text-align: center">⁂</div>

[^1]: https://realpython.com/python-pep8/

[^2]: https://realpython.com/ref/glossary/pep-8/

[^3]: https://pythonworld.ru/osnovy/pep-8-rukovodstvo-po-napisaniyu-koda-na-python.html

[^4]: https://sky.pro/media/pep8/

[^5]: https://peps.python.org/pep-0008/

[^6]: https://defpython.ru/pep8

[^7]: https://python-school.ru/blog/python/pep-8/

[^8]: https://llego.dev/posts/writing-clean-pep-8-compliant-code-better-collaboration/

[^9]: https://pythonist.ru/pep-8-kommentarii-probely-vybor-metodov/

[^10]: https://pyplanet.ru/article/pep-0008.html

[^11]: https://sky.pro/media/chto-takoe-pep-8-i-kak-sledovat-stilyu-kodirovaniya-v-python/

[^12]: https://habr.com/ru/articles/836642/

[^13]: https://letpy.com/python-guide/pep8/

[^14]: https://elpythonista.com/pep8

[^15]: http://kist.ntu.edu.ua/gurtok/pep8.pdf

[^16]: https://python.ivan-shamaev.ru/pep8-python-code-rules-programmers-guide/

[^17]: https://github.com/Searge/mipt_oop/blob/master/week_1/readme.md

[^18]: https://luminousmen.com/post/the-ultimate-python-style-guidelines/

[^19]: https://pypi.org/project/pep8/

[^20]: https://github.com/kenshoo/python-style-guide

[^21]: https://gb.ru/posts/pep8

[^22]: https://synergy.ru/akademiya/programming/kak_sostavlyat_kommentarii_v_python

[^23]: https://pythonru.com/uroki/28-kak-pisat-kommentarii-dlja-nachinajushhih

[^24]: https://dvmn.org/encyclopedia/clean_code/python_basics_pep8/

[^25]: https://pikabu.ru/story/kak_pisat_krasivyiy_kod_s_pep_8_chast_1_6421732

[^26]: https://defpython.ru/pep8__korotko_o_glavnom

[^27]: https://www.reddit.com/r/learnpython/comments/r6n9j9/what_is_pep8_in_python/

[^28]: https://docs-python.ru/tutorial/pep-rukovodstvo-stilju-koda-python/

[^29]: https://www.python.org

[^30]: https://www.python.org/doc/essays/styleguide/

[^31]: https://habr.com/ru/articles/693668/comments/

